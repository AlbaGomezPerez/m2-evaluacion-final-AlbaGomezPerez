"use strict";const inputSerie=document.querySelector(".fill"),inputValue=document.querySelector(".value"),button=document.querySelector(".button"),series=document.querySelector(".space-series"),favouriteSpace=document.querySelector(".favourite-Space"),url="http://api.tvmaze.com/search/shows?q=";function serching(){fetch(url+inputValue.value).then(handleErrors).then(e=>e.json()).then(e=>{series.innerHTML="";for(let t=0;t<e.length;t++){let r={id:e[t].show.id,name:e[t].show.name};null===e[t].show.image?r.imageMedium="https://via.placeholder.com/210x295/ffffff/666666/?text=TV":r.imageMedium=e[t].show.image.medium,series.innerHTML+=generateSerieContent(r)}for(let e of document.querySelectorAll(".noLike"))e.addEventListener("click",favSav)}).catch(function(e){console.log(e),series.innerHTML="Vuelve a intentarlo mÃ¡s tarde, se ha producido un error"})}function favSav(e){e.target.classList.add("like"),e.target.classList.remove("noLike");let t=localStorage.getItem("favouriteSerieListStored");null==t?t=[e.target.id]:(t=JSON.parse(t)).push(e.target.id),localStorage.setItem("favouriteSerieListStored",JSON.stringify(t))}function isFavouriteSerie(e){let t=localStorage.getItem("favouriteSerieListStored");return null==t?"noLike":(t=JSON.parse(t)).includes(e)?"like":"noLike"}function handleErrors(e){if(!e.ok)throw Error(e.statusText);return e}function showFavourites(){const e=JSON.parse(localStorage.getItem("favouriteSerieListStored"));for(let t of e){const e=JSON.parse(decodeURIComponent(t));console.log(e),favouriteSpace.innerHTML+=generateSerieContent(e)}}function generateSerieContent(e){const t=encodeURIComponent(JSON.stringify(e));let r='<div class="serie-space">';return r+='<ul class="serie" >',r+='<li class="space-title '+isFavouriteSerie(t)+'" id="'+t+'">'+e.name+"</li>",r+='<li class="space-image"><img src="'+e.imageMedium+'"/></li>',r+='<li class="reference">'+e.id+"</li>",r+="</ul>",r+="</div>"}button.addEventListener("click",serching),inputValue.addEventListener("keyup",e=>{13===e.keyCode&&serching()}),showFavourites();