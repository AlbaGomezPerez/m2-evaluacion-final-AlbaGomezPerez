"use strict";const inputValue=document.querySelector(".value"),searchButton=document.querySelector(".search-button"),inputGenre=document.querySelector(".genre"),searchButton2=document.querySelector(".search-button2"),moreInfo=document.querySelector(".info"),series=document.querySelector(".space-series"),favouriteSpace=document.querySelector(".favourite-Space"),reset=document.querySelector(".remove"),collapsable=document.querySelector(".favourite-Space-title"),favouritesSaved=document.querySelector(".my-favs"),url="http://api.tvmaze.com/search/shows?q=";function serching(){fetch(url+(inputValue.value||inputGenre.value)).then(handleErrors).then(e=>e.json()).then(e=>{series.innerHTML="";for(let t=0;t<e.length;t++){let r={id:e[t].show.id,name:e[t].show.name};null===e[t].show.image?r.imageMedium="https://via.placeholder.com/210x295/ffffff/666666/?text=TV":r.imageMedium=e[t].show.image.medium,series.innerHTML+=generateSerieContent(r)}updateFavoriteClickEvent()}).catch(function(e){console.log(e),series.innerHTML="Vuelve a intentarlo mÃ¡s tarde, se ha producido un error"})}function favSav(e){let t=JSON.parse(localStorage.getItem("favouriteSerieListStored")),r=!1;if(null!=t&&(r=t.includes(e.target.id)),r){const r=document.querySelectorAll("[id='"+e.target.id+"']");for(let e of r)e.classList.add("noLike"),e.classList.remove("like");null===t&&void 0===t||(t=t.filter(function(t,r,i){return t!==e.target.id}))}else e.target.classList.add("like"),e.target.classList.remove("noLike"),null==t?t=[e.target.id]:t.push(e.target.id);localStorage.setItem("favouriteSerieListStored",JSON.stringify(t)),showFavourites()}function isFavouriteSerie(e){let t=localStorage.getItem("favouriteSerieListStored");return null==t?"noLike":(t=JSON.parse(t)).includes(e)?"like":"noLike"}function handleErrors(e){if(!e.ok)throw Error(e.statusText);return e}function showFavourites(){favouriteSpace.innerHTML="";const e=JSON.parse(localStorage.getItem("favouriteSerieListStored"));if(null!=e&&null!=e)for(let t of e){const e=JSON.parse(decodeURIComponent(t));favouriteSpace.innerHTML+=generateSerieContent(e)}updateFavoriteClickEvent()}function generateSerieContent(e){const t=encodeURIComponent(JSON.stringify(e));let r='<div class="serie-space">';return r+='<ul class="serie" >',r+='<li class="space-title '+isFavouriteSerie(t)+'" id="'+t+'">'+e.name+"</li>",r+='<li class="space-image"><img src="'+e.imageMedium+'"/></li>',r+='<li class="reference">'+e.id+"</li>",r+='<li class="info"> <a class="link" href= "_src/templates/partials/_info.html" ></a> </li>',r+="</ul>",r+="</div>"}function removing(){localStorage.clear(),showFavourites()}function updateFavoriteClickEvent(){for(let e of document.querySelectorAll(".noLike"))e.addEventListener("click",favSav);for(let e of document.querySelectorAll(".like"))e.addEventListener("click",favSav)}function openFavourites(){favouritesSaved.classList.contains("hidden")?favouritesSaved.classList.remove("hidden"):favouritesSaved.classList.add("hidden")}function showInfo(){console.log("funciono")}searchButton.addEventListener("click",serching),searchButton2.addEventListener("click",serching),inputValue.addEventListener("keyup",e=>{13===e.keyCode&&serching()}),showFavourites(),reset.addEventListener("click",removing),collapsable.addEventListener("click",openFavourites),moreInfo.addEventListener("click",showInfo);